# Configurações de Ambiente - API de Pagamentos Sicredi

# ============================================================================
# SPRING BOOT
# ============================================================================
SPRING_PROFILES_ACTIVE=dev
SPRING_APPLICATION_NAME=toolschallenge

# ============================================================================
# POSTGRESQL - Banco de Dados Principal
# ============================================================================
POSTGRES_HOST=localhost
POSTGRES_PORT=5432
POSTGRES_DB=pagamentos
POSTGRES_USER=postgres
POSTGRES_PASSWORD=postgres
POSTGRES_DRIVER=org.postgresql.Driver
POSTGRES_HIKARI_MAX_POOL_SIZE=10
POSTGRES_HIKARI_MIN_IDLE=5
POSTGRES_HIKARI_CONNECTION_TIMEOUT=30000

# ============================================================================
# FLYWAY - Migrações de Schema
# ============================================================================
FLYWAY_ENABLED=true
FLYWAY_BASELINE_ON_MIGRATE=true
FLYWAY_LOCATIONS=classpath:db/migration

# ============================================================================
# REDIS - Cache e Idempotência
# ============================================================================
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_PASSWORD=redis123
REDIS_TIMEOUT=2000

# ============================================================================
# KAFKA - Mensageria Assíncrona
# ============================================================================
KAFKA_BOOTSTRAP_SERVERS=localhost:9092
KAFKA_CONSUMER_GROUP_ID=pagamentos-group
KAFKA_AUTO_OFFSET_RESET=earliest

# ============================================================================
# SERVIDOR - Portas e Configurações HTTP
# ============================================================================
SERVER_PORT=8080

# ============================================================================
# ACTUATOR - Monitoramento e Health Checks
# ============================================================================
MANAGEMENT_PORT=8080
MANAGEMENT_BASE_PATH=/atuador
MANAGEMENT_ENDPOINTS_ENABLED=health,info,metrics,prometheus,circuitbreakers,circuitbreakerevents
MANAGEMENT_HEALTH_SHOW_DETAILS=always

# ============================================================================
# PROMETHEUS - Métricas
# ============================================================================
PROMETHEUS_ENABLED=true
PROMETHEUS_METRICS_EXPORT_ENABLED=true

# ============================================================================
# DISTRIBUTED TRACING - Jaeger/Zipkin
# ============================================================================
TRACING_ENABLED=true
TRACING_SAMPLING_PROBABILITY=1.0
ZIPKIN_ENDPOINT=http://localhost:9411/api/v2/spans

# ============================================================================
# RESILIENCE4J - Circuit Breaker, Retry, Bulkhead
# ============================================================================
# Circuit Breaker Adquirente
CIRCUIT_BREAKER_FAILURE_RATE_THRESHOLD=50
CIRCUIT_BREAKER_SLIDING_WINDOW_SIZE=10
CIRCUIT_BREAKER_MIN_CALLS=5
CIRCUIT_BREAKER_WAIT_DURATION=10s
CIRCUIT_BREAKER_HALF_OPEN_CALLS=3

# Retry Adquirente
RETRY_MAX_ATTEMPTS=3
RETRY_WAIT_DURATION=500ms

# Bulkhead Adquirente
BULKHEAD_MAX_THREAD_POOL_SIZE=10
BULKHEAD_CORE_THREAD_POOL_SIZE=5
BULKHEAD_QUEUE_CAPACITY=20
BULKHEAD_KEEP_ALIVE_DURATION=20ms

# ============================================================================
# ADQUIRENTE SIMULADO - Chaos Engineering
# ============================================================================
# Taxa de falhas (0.0 = sem falhas, 1.0 = 100% falhas)
ADQUIRENTE_FAILURE_RATE=0.0
# Latência artificial em ms
ADQUIRENTE_LATENCY_MS=100
# Taxa de timeouts (0.0 = sem timeouts, 1.0 = 100% timeouts)
ADQUIRENTE_TIMEOUT_RATE=0.0
# Taxa de aprovação (1.0 = 100% aprovado)
ADQUIRENTE_APROVACAO_RATE=1.0

# ============================================================================
# REPROCESSAMENTO - Scheduler de Transações Pendentes
# ============================================================================
REPROCESSAMENTO_ENABLED=true
REPROCESSAMENTO_INTERVALO_MINUTOS=5
REPROCESSAMENTO_BATCH_SIZE=50
REPROCESSAMENTO_MAX_TENTATIVAS=3

# ============================================================================
# JWT - Autenticação e Autorização
# ============================================================================
# ATENÇÃO: Gerar chave secreta segura em produção (256+ bits)
# Comando: openssl rand -base64 32
JWT_SECRET=toolschallenge-secret-key-change-in-production-256bits-minimum
# Expiração: 30 dias em millisegundos
JWT_EXPIRATION_MS=2592000000
JWT_ISSUER=toolschallenge-api

# ============================================================================
# LOGGING - Níveis de Log
# ============================================================================
LOGGING_LEVEL_ROOT=INFO
LOGGING_LEVEL_APP=DEBUG
LOGGING_LEVEL_SPRING_WEB=INFO
LOGGING_LEVEL_KAFKA=WARN
LOGGING_LEVEL_HIBERNATE=INFO
LOGGING_PATTERN_CONSOLE=%d{yyyy-MM-dd HH:mm:ss} - %msg%n

# ============================================================================
# SWAGGER/OPENAPI - Documentação da API
# ============================================================================
SPRINGDOC_API_DOCS_PATH=/v3/api-docs
SPRINGDOC_SWAGGER_UI_PATH=/swagger-ui.html
SPRINGDOC_SWAGGER_UI_ENABLED=true

# ============================================================================
# GRAFANA - Visualização de Métricas
# ============================================================================
GRAFANA_URL=http://localhost:3000
GRAFANA_USER=admin
GRAFANA_PASSWORD=admin123

# ============================================================================
# JAEGER - Distributed Tracing
# ============================================================================
JAEGER_UI_URL=http://localhost:16686
JAEGER_COLLECTOR_ENDPOINT=http://localhost:14268
JAEGER_ZIPKIN_ENDPOINT=http://localhost:9411

# ============================================================================
# KAFKA UI - Interface Gráfica Kafka
# ============================================================================
KAFKA_UI_URL=http://localhost:8081

# ============================================================================
# EXPORTERS - Métricas de Infraestrutura
# ============================================================================
POSTGRES_EXPORTER_PORT=9187
REDIS_EXPORTER_PORT=9121
KAFKA_EXPORTER_PORT=9308

# ============================================================================
# ZOOKEEPER - Coordenação Kafka
# ============================================================================
ZOOKEEPER_CLIENT_PORT=2181
ZOOKEEPER_TICK_TIME=2000
